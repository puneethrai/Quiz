define(function(){var a={_connection:null,_currentIndex:0,_db:null,PROPERTIES:{dbName:"quiz",dbVersion:"",dbDescription:"Quiz wizard",dbSize:2e5},QUERIES:{createTableQuiz:"CREATE TABLE IF NOT EXISTS QUIZ( id INTEGER PRIMARY KEY AUTOINCREMENT, testID INTEGER, input, attempts INTEGER, totalattempt INTEGER, result )",insertIntoQuiz:'INSERT INTO QUIZ(id,testID,input,attempts,totalattempt, result) VALUES (NULL,"',updateQuiz:"UPDATE QUIZ SET testID='--T--',input='--I--',attempts='--A--',totalattempt='--TT--',result='--R--' WHERE id=?",dropQuizTable:" DROP TABLE IF EXISTS QUIZ",selectAllFromQuiz:"SELECT * FROM QUIZ ORDER BY testID",searchContact:"SELECT * FROM OTRANSACTION WHERE name LIKE '--S--%' OR mobileNo LIKE '--S--%' OR workNo LIKE '--S--%' OR homeNo LIKE '--S--%' OR avataruri LIKE '--S--%' OR email LIKE '--S--%' OR homeAdd LIKE '--S--%' OR workAdd LIKE '--S--%'  ORDER BY jid",searchExistingID:"SELECT * FROM QUIZ WHERE testID = ?",deleteQuiz:"DELETE FROM QUIZ WHERE id = ?"},initialize:function(){var a=this,b=$.Deferred();return a._db||(a._db=window.openDatabase(this.PROPERTIES.dbName,this.PROPERTIES.dbVersion,this.PROPERTIES.dbDescription,this.PROPERTIES.dbSize),a._db&&a._executeSql(a.QUERIES.dropQuizTable,null,function(){a._executeSql(a.QUERIES.createTableQuiz,null,function(){b.resolve()},function(){b.reject()})})),b.promise()},getAllQuiz:function(){var a=this,b=$.Deferred();return a._db&&a._executeSql(a.QUERIES.selectAllFromQuiz,null,function(a,c){var d=[],e=0;for(e=0;e<c.rows.length;e++)b.notify(c.rows.item(e)),d.push(c.rows.item(e));b.resolve(d)},function(){b.reject()}),b.promise()},getQuizByTestID:function(a){var b=this,c=$.Deferred();return b._db&&b._executeSql(b.QUERIES.searchExistingID,[a],function(a,b){1===b.rows.length?c.resolve(b.rows.item(0)):c.reject()},function(){c.reject()}),c.promise()},addQuiz:function(a){var b=this,c=$.Deferred(),d="",e=[];return a.id?(d=b.QUERIES.updateQuiz.replace("--T--",a.testID).replace("--I--",a.input).replace("--A--",a.attempts).replace("--TT--",a.totalattempt).replace("--R--","none"),e=[a.id]):d=b.QUERIES.insertIntoQuiz+a.testID+'","'+a.input+'","'+a.attempts+'","'+a.totalattempt+'","blah")',a.id=a.id||"NULL",b._db&&b._executeSql(d,e,function(a,b){b.rows.length>0?c.resolve(b.rows.item(0)):0===e.length?c.resolve(b.insertId):c.resolve()},function(){c.reject()}),c.promise()},removeQuiz:function(a){var b=this,c=$.Deferred();return b._executeSql(b.QUERIES.deleteQuiz,[a],function(){c.resolve()},function(){c.reject()}),c.promise()},_executeSql:function(a,b,c,d,e){var f=this,g=function(d,e){f._logger(a+(b||"--No prams--")+" - finished","DEBUG","_executeSql"),c&&c(d,e)},h=function(c,e){return f._logger(a+(b||"--No prams--")+" - error: "+e.message,"DEBUG","_executeSql"),d?d(c,e):void 0};e&&e.transaction?e.transaction.executeSql(a,b,g,h):this._db.transaction(function(c){c.executeSql(a,b,g,h)})},_logger:function(a,b,c){!c&&arguments.callee&&arguments.callee.caller&&(c=arguments.callee.caller.name||arguments.callee.caller.toString()),console.log(a)}};return a});